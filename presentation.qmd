---
title: "Mixed Effect Models"
format:
  revealjs:
    incremental: true   
author: "Jason Moggridge"
author-meta: "Mt Sinai LTRI"
date: '`r Sys.Date()`'
---


## Linear models have "fixed" effects

:::: {.columns}

::: {.column width="50%"}

- Parameters in simple statistical models
  - estimating a population mean 
  - estimating a slope or correlation
  
:::

::: {.column width="50%"}

```{r fig.height=6, fig.width=6}
library(ggplot2)
library(palmerpenguins)
library(patchwork)
f1 <- penguins |>
  ggplot(aes(body_mass_g)) + 
  geom_histogram(color = 'white', alpha = .65) +
  geom_vline(aes(xintercept = mean(body_mass_g, na.rm = T)),
             color = 'blue', linewidth = 2, alpha = 0.5) +
  labs(x = "mass (g)")

f2 <- penguins |> 
  ggplot(aes(body_mass_g, flipper_length_mm)) +
  geom_point(alpha = .5) +
  geom_smooth(method = 'lm') +
  labs(x = 'mass (g)', y = 'flipper length (mm)')

f1 / f2
```

:::
::::
  
----

## Fixed effects models

- Dependent variable ~ factors + covariates (indep. variables)
- Conceptually, these parameters are unvarying throughout the universe
- Error on parameter estimate is only due to sampling 
- Call these **fixed effects** to distinguish from **random effects**

![](img/fixed_effect.svg)



----

## Mixed effects models

Useful when experimental design violates assumptions of ANOVA (linear model), eg:

- repeated measurements (within-subjects design)
  - 
- hierarchical sampling structure (nested groups)
  - Multi-center clinical trials


----

## Repeated measurements


##

----

## Mixed effects models

Assumption is that model parameters vary for different factors. They are drawn from a distribution


----

## Random Effects

- effect size can vary between:
  - individuals measured repeatedly
  - groups, panels, studies, populations, etc.
 
- samples are drawn from a universe of populations
 - 'random effect' is sampled from distribution of effects

----

## Fixed effect estimation 

- math is simpler
- uncertainty is smaller
- may or may not be more 'efficient'
  
  $$ \tilde y =  \beta_1x + \beta_0 + \epsilon $$

----

## Terminology Alert

::: {.warn}
Statistics nomenclature is always ambiguous

:::

Random effects models, AKA 
 - hierarchical models
 - multilevel models
 - mixed models
 - varying coefficients model
 
These could refer to the same method or not...


----

## Definition of fixed & random effects

- Fixed effects are estimated by maximum likelihood (eg. least squares)

- Random effects are estimated with shrinkage

- This definition is used in the multilevel modelling literature 

- Other definitions of random effects exist
