---
title: "Fixed and Random Effects Models"
title-slide-attributes:
  data-background-image: ./img/logos.jpg
  data-background-size: contain
  data-background-opacity: "1"
subtitle: "How should we pool effect sizes in meta-analysis?"
author: "Jason Moggridge, LTRI"
format: 
  revealjs:
    embed-resources: true
    auto-stretch: false
    incremental: false
    theme: 'simple'
    pointer:
      pointerSize: 24
      alwaysVisible: false
revealjs-plugins:
  - pointer
backgroundcolor: '#f5fafe'
date: '2024-07-30'
transition: 'fade'
transition-speed: 'default'
---
<head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

--------------------------------------------------------------------

## About Me {transition="fade"}

<!-- :::::{.incremental} -->
::::{.columns}
:::{.column width=60%}

[{{< bi envelope-at >}} ja.moggridge @ gmail](https://github.com/jmoggridge)

[{{< bi github >}} jmoggridge](https://github.com/jmoggridge)

[{{< bi mastodon >}} vis.social/@jmoggridge](https://vis.social/@jmoggridge)


*Education*:   
- M Bioinformatics, U of Guelph  
- BSc Biochem, Carleton U 

*Work*: Data analysis, software, and web dev  

*Interests*: bio, comp-sci, stats & ML

*Fun*: outdoor sports & naturalism



:::

::: {.column width="40%"}
![Harbour seal (*Phoca vitulina*) at Ruckle park. ](./img/seal.jpg){fig-align='right' }    
:::
::::
<!-- ::::: -->

# Meta-analysis Recap {transition="fade-in slide-out"}

## Meta-analysis Recap

::::{.incremental}
- **Goal**: Estimate the true effect size from multiple studies   

:::{.incremental transition="slide-in" transition-speed="fast"}
- **Steps**:
  - define research question (PICOT)
  - collect results from appropriate studies
  - apply statistical model*

:::
::::

--------------------------------------------------------------------

## Meta-analysis Data {transition="slide-in slide-out"}

:::{.incremental}
- dataset is $K$ studies
- each independent study is an observation with variables:
  - estimated effect size ($\widehat{\theta}_{k}$)  
  - standard error ($\epsilon_{k}$ or $SE_{k}$)  
  - sample size ($n_{k}$)   

:::

--------------------------------------------------------------------

## How should we pool effect sizes? {transition="slide-in fade-out"}

<br>
To get our meta-analysis result, we need to take a **weighted average of effect sizes**...

. . . 

<br>
But *how* should we weigh the evidence of each study?

--------------------------------------------------------------------

## Meta-analysis Models {transition="fade-in slide-out"}

- **Fixed effects** and **random effects** models make different assumptions about how data were generated
- Model should approximate the underlying processes

<!-- ---------------------------------------------------------- -->

# Fixed Effects Model {transition="slide-in slide-out"}

--------------------------------------------------------------------

## Fixed Effects Assumption {transition="fade"}

- One true effect size ($\theta_{\ F }$)
- Deviation from $\theta_{\ F}$ is due to sampling error ($\epsilon_{\ k}$)

![](img/fixed-effects.jpg){height=450px fig-align='center'}    

--------------------------------------------------------------------

## Inverse-Variance Weighting

<br>

- Error ($\epsilon_{\ k }$) is inversely proportional to sample size $n_{k}$.
- Estimates ($\widehat{\theta}_{k}$) with small $\epsilon_{\ k }$ should be closer to true $\theta$
- These $\widehat{\theta}_{k}$ should be given more weight for estimating $\theta$


--------------------------------------------------------------------

## Inverse-Variance Weighting

<br>

 Study weight $w_{k}$ is inversely related to the variance ($SE^2_{k}$)

$$
w_{k}=\frac{1}{(SE)^{2}_{k}}
$$

The pooled estimate $\widehat{\theta}$ is the weighted average:

$$
 \widehat{\theta} = \frac{\Sigma^K_{k=1}\widehat{\theta}_{k} w_{k}}{\Sigma^K_{k=1}w_{k}}
$$

--------------------------------------------------------------------

## FEM Standard Error

To compute the standard error on our averaged result $\widehat\theta$

$$
SE(\widehat{\theta}) = \frac{1}{\Sigma^K_{k=1}w_{k}}
$$


--------------------------------------------------------------------

## FEM Assumptions & Interpretation 

:::{.incremental}

- All studies are sampling a completely homogeneous population
- All studies performed in exactly the same manner
- No between-study heterogeneity
:::

. . . 

Too simplistic to account for differences between studies.


<!-- --------------------------------------------------------- -->

# Random Effects Model {transition="fade-in slide-out"}

--------------------------------------------------------------------

## Random Effects Assumption

- A universe of possible studies
- Each study has own true effect size ($\theta_k$)
- $\theta_{k}$ are randomly drawn from a distribution with mean true effect size $\mu$ and variance ($\tau^2$)

![](./img/mu_and_tau.jpg){height=300px fig-align='center'}

--------------------------------------------------------------------

## Random Effects Model


The true effect size of study *$k$* ($\theta_{k}$) is drawn from a distribution with mean $\mu$ with error $\zeta_{k}$.

$$
{\theta}_{k}=\mu+\zeta_{k}
$$

The reported result ($\widehat{\theta}_{k}$) of a study is generated by the true effect size ($\theta_{k}$) plus sampling error ($\epsilon_{k}$).

$$
 \widehat{\theta}_{k}=\theta_{k} +\epsilon_{k}
$$

--------------------------------------------------------------------

## Random Effects Model

- We can conceptualize the REM having a hierarchical structure

![](img/rand_eff.jpg){width=100% fig-align='center'}

--------------------------------------------------------------------

## REM weighting

- uses the between-study heterogeneity of true effects, $\tau^2$
- $\tau^2$ increases the relative weight given to smaller studies

$$
w^{*}_{k}=\frac{1}{SE^{2}_{k} + \tau^2}
$$

. . .

Then compute the weighted average in the usual fashion.

--------------------------------------------------------------------

## Estimating $\tau^2$

- Beyond the scope of this talk!
- Many procedures exist (16+ different estimators)
- DerSimonian and Laird method treated as default, controversially

--------------------------------------------------------------------

## Exchangeability Assumption

- There is no way to know what $\zeta_{k}$ is *a priori*
- This assumption may be violated by hidden information, e.g., publication bias

--------------------------------------------------------------------

## Should we just always use the REM?

<br>

- For most scenarios in biology, medicine, psych., ... use the REM.
- Only choose the FEM if you have clear reason to (rare)

--------------------------------------------------------------------

## A Test for Between-Study Heterogeneity

<br>

- Does the confidence interval for $\tau^2$ include zero or not?
- If not, using REM is justified


--------------------------------------------------------------------

## References & Further Reading

- [Cochrane Handbook for Systematic Reviews of Interventions](https://training.cochrane.org/handbook/current/chapter-10)  

- [Doing Meta-Analysis in R: A Hands-On Guide](https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/)

- [Methods to estimate the between‐study variance and its uncertainty in meta‐analysis](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4950030/)

- [Why I don’t use the term “fixed and random effects”](https://statmodeling.stat.columbia.edu/2005/01/25/why_i_dont_use/) 
  
- [Stats, Stat!: Meta-analysis](https://www.youtube.com/watch?v=rg0L3Ridriw&list=PLI8Ak-hj5dgEovGlan5oBZiyWx1sLqpMt)

- [An Introduction to Systematic Review and Meta-analysis: Everything you need to know in 59 minutes](https://www.youtube.com/watch?v=aG7jvwDNXtk)


--------------------------------------------------------------------

## Questions? {transition="fade-in slide-out"}

<br>
<br>
<br>

::: {.callout-tip}
My slides are online here:<br> [https://jmoggridge.github.io/fixed-and-random-effects](https://jmoggridge.github.io/fixed-and-random-effects)
:::